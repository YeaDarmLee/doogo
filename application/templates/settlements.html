<!-- header -->
{% include './common/header.html' %}

<style>
  .card-body {
    padding: 0.75rem;
  }
</style>

<script>
  $(function() {
    // 시작일 달력
    $("#startDate").datepicker({
      dateFormat: "yy-mm-dd",
      changeMonth: true,
      changeYear: true,
      onClose: function(selectedDate) {
        // 시작일 선택 시 종료일 최소값 제한
        $("#endDate").datepicker("option", "minDate", selectedDate);
      }
    });

    // 종료일 달력
    $("#endDate").datepicker({
      dateFormat: "yy-mm-dd",
      changeMonth: true,
      changeYear: true,
      onClose: function(selectedDate) {
        // 종료일 선택 시 시작일 최대값 제한
        $("#startDate").datepicker("option", "maxDate", selectedDate);
      }
    });
  });
</script>

<body id="page-top">
  <div id="wrapper">
    {% include './common/sidebar.html' %}

    <div id="content-wrapper" class="d-flex flex-column">
      <div id="content">
        <div class="container-fluid">
          <!-- Page Heading -->
          <h1 class="h3 mb-2 text-gray-800">정산 기록</h1>
          <p class="mb-4">지정한 날짜 정보로 정산 기록을 조회합니다.</p>
          
          <!-- 리스트 카드 -->
          <div class="card shadow mt-4">
            <div class="card-header py-3 d-sm-flex align-items-center">
              <h6 class="m-0 font-weight-bold text-primary">정산 목록</h6>
              
              <input type="text" class="form-control form-control-user ml-2"
                id="startDate" name="startDate"
                value="{{ startDate }}" placeholder="시작일"
                style="width: 120px;">
              &nbsp;~&nbsp;
              <input type="text" class="form-control form-control-user"
                id="endDate" name="endDate"
                value="{{ endDate }}" placeholder="종료일"
                style="width: 120px;">

                <a id="btnSearch" class="d-sm-inline-block btn btn-sm btn-primary shadow-sm ml-2" href="javascript:#">검색</a>
            </div>

            <div class="card-body">
              <div class="table-responsive">
                <table class="table table-bordered text-center" id="dataTable" width="100%" cellspacing="0">
                  <thead>
                    <tr>
                      <th>#</th>
                      <th>주문ID</th>
                      <th>결제수단</th>
                      <th>승인일시</th>
                      <th>금액</th>
                      <th>수수료</th>
                      <th>정산예정일</th>
                      <th>상태</th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for i in items %}
                      <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ i.orderId }}</td>
                        <td>{{ i.method }}</td>
                        <td>{{ i.approvedAt }}</td>
                        <td>{{ "{:,.0f}".format(i.amount) }}원</td>
                        <td>{{ "{:,.0f}".format(i.fee) }}원</td>
                        <td>{{ i.paidOutDate }}</td>
                        <td>{{ i.transfer.settlementStatus if i.transfer else (i.cancel.cancelStatus if i.cancel else "정상") }}</td>
                      </tr>
                    {% endfor %}
                  </tbody>
                </table>
              </div>
              <!-- 서버에서 대기/반려만 내려주면 단순. 필요 시 필터 추가 가능 -->
            </div>
          </div>

        </div>
      </div>

      {% include './common/copyright.html' %}
    </div>
  </div>

  <a class="scroll-to-top rounded" href="#page-top">
    <i class="fas fa-angle-up"></i>
  </a>

  {% include './common/footer.html' %}
</body>
